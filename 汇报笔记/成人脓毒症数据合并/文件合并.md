

# 文件合并

当前任务的目的是需要将术前和术后的数据根据ID拼接到一起，但是术前的文件和术后的文件都是根据时间节点存放在不同的文件当中的，因此我们需要将术前的和术后的所有小文件合并为一个术前的大文件和术后的大文件，再将两个文件合并到一起。考虑到文件较小，因此采用全部读取出来直接合并的方式。

## 多个术前/术后小文件合并为一个术后大文件

​	因为文件容量较小，因此采用直接合并的方式。所有文件读取到内存再直接上下拼接。

## 文件合并Key格式统一

文件在通过某一个key进行合并的时候，key的类型是需要统一的（值相同类型不同的情况下不会合并成功）。因此 需要将Key统一为String类型。考虑到文件较小，因此直接将读出来的文件数据使用pandas转换文件类型。

## 文件合并（通过key的方式的）

术前和术后的数据有重合的字段有14个（['手麻手术排程ID', '住院号', '状态', '患者姓名', '性别', '生日', '年龄', '床号', '科室', '脉搏氧饱和度', '肺不张', '麻醉方式', '日期', '日期.1']），考虑到唯一性的问题，因此使用'手麻手术排程ID'作为文件合并的key



